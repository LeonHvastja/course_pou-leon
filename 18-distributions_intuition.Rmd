# Distributions intutition

This chapter is intended to help you familiarize yourself with the different 
probability distributions you will encounter in this course.

Use [Appendix B](#distributions) as a reference for the basic properties of distributions. 


```{r, echo = FALSE}
togs   <- T
tog_ex <- T
```



<style>
.fold-btn { 
  float: right; 
  margin: 5px 5px 0 0;
}
.fold { 
  border: 1px solid black;
  min-height: 40px;
}
</style>

<script type="text/javascript">
$(document).ready(function() {
  $folds = $(".fold");
  $folds.wrapInner("<div class=\"fold-blck\">"); // wrap a div container around content
  $folds.prepend("<button class=\"fold-btn\">Unfold Solution</button>");  // add a button
  $(".fold-blck").toggle();  // fold all blocks
  $(".fold-btn").on("click", function() {  // add onClick event
    $(this).text($(this).text() === "Fold Solution" ? "Unfold Solution" : "Fold Solution");  // if the text equals "Fold", change it to "Unfold"or else to "Fold" 
    $(this).next(".fold-blck").toggle("linear");  // "swing" is the default easing function. This can be further customized in its speed or the overall animation itself.
  })
});
</script>


## Discrete distributions

```{exercise, name = "Bernoulli intuition 1"}
Arguably the simplest distribution you will enocounter is the Bernoulli distribution.
It is a discrete probability distribution used to represent the outcome of a yes/no
question. It has one parameter $p$ which is the probability of success. The 
probability of failure is $1-p$, sometimes denoted as $q$.

A classic way to think about a Bernoulli trial (a yes/no experiment) is a coin 
flip. Real coins are fair, meaning the probability of either heads (1) 
or tails (0) are the same i.e. $p=0.5$, shown below in *figure a*. Alternatively
we may want to represent a process that doesn't have equal probabilities of outcomes
like "Will a throw of a fair die result in a 6?". In this case $p=\frac{1}{6}$, 
shown in *figure b*.

Using your knowledge of the Bernoulli distribution use the throw of a fair die 
to think of events, such that:

a) $p = 0.5$
b) $p = \frac{5}{6}$
c) $q = \frac{2}{3}$
```

```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)

# Create data
df <- data.frame(
  outcome = rep(c(0, 1), 2),
  probability = c(1-0.5, 0.5, 1-1/6, 1/6),
  p_value = factor(rep(c("a", "b"), each=2))
)

# Plot
ggplot(df, aes(x=factor(outcome), y=probability)) +
  geom_segment(aes(xend=factor(outcome), yend=0), color='black') +
  geom_point(color="red", size=3) +
  coord_cartesian(ylim = c(0, 1)) +
  labs(y = "Probability", x = "Outcome") +
  theme(legend.position="none") +
  facet_wrap(~p_value, ncol=2, scales = "free_x", labeller = label_parsed)

```

<div class="fold">
```{solution, echo = togs}
a. An event that is equally likely to happen or not happen i.e. $p = 0.5$ would be
throwing an even number. More formally we can name this event $A$ and write:
  $A = \{2,4,6\}$, its probability being $P(A) = 0.5$


b. An example of an event with $p = \frac{5}{6}$ would be throwing a number 
greater than 1. Defined as $B = \{2,3,4,5,6\}$.

c. We need an event that fails $\frac{2}{3}$ of the time. Alternatively we can 
reverse the problem and find an event that succeeds $\frac{1}{3}$ of the time, 
since: $q = 1 - p \implies p = 1 - q = \frac{1}{3}$. The event that our outcome
is divisible by 3: $C = \{3, 6\}$ satisfies this condition.
```
</div>

```{exercise, name = "Binomial intuition 1"}
The binomial distribution is a generalization of the Bernoulli distribution. 
Instead of considering a single Bernoulli trial, we now consider a sequence of $n$ trials,
which are independent and have the same parameter $p$. So the binomial distribution
has two parameters $n$ - the number of trials and $p$ - the probability of success
for each trial.

If we return to our coin flip representation, we now flip a coin several times.
The binomial distribution will give us the probabilities of all possible outcomes.
Below we show the distribution for a series of 10 coin flips with a fair coin 
(left) and a biased coin (right). The numbers on the x axis represent the 
number of times the coin landed heads.

Using your knowledge of the binomial distribution:

a. Take the [pmf of the binomial distribution](#distributions)  and plug in $n=1$,
check that it is in fact equivalent to a Bernoulli distribution.

b. In our examples we show the graph of a binomial distribution over 10 trials with
$p=0.8$. If we take a look at the graph, it appears as though the probabilities of getting 0,1,2 or 3
heads in 10 flips are zero. Is it actually zero? Check by plugging in the values
into the pmf.
```

<div class="fold">
```{solution, echo = togs}
a. The pmf of a binomial distribution is $\binom{n}{k} p^k (1 - p)^{n - k}$, now
we insert $n=1$ to get: 
  $$\binom{1}{k} p^k (1 - p)^{1 - k}$$.
Not quite equivalent to
a Bernoulli, however note that the support of the binomial distribution is 
defined as $k \in \{0,1,\dots,n\}$, so in our case $k = \{0,1\}$, then:
  $$\binom{1}{0} = \binom{1}{1} = 1$$ 
  we get:  $p^k (1 - p)^{1 - k}$ ,the Bernoulli distribution.

b. As we already know $p=0.8, n=10$, so:
  $$\binom{10}{0} 0.8^0 (1 - 0.8)^{10 - 0} = 1.024 \cdot 10^{-7}$$
  $$\binom{10}{1} 0.8^1 (1 - 0.8)^{10 - 1} = 4.096 \cdot 10^{-6}$$
  $$\binom{10}{2} 0.8^2 (1 - 0.8)^{10 - 2} = 7.3728 \cdot 10^{-5}$$
  $$\binom{10}{3} 0.8^3 (1 - 0.8)^{10 - 3} = 7.86432\cdot 10^{-4}$$
  So the probabilities are not zero, just very small.
```
</div>


```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)

# Data for binomial distribution
df1 <- data.frame(
  outcome = 0:10,
  probability = dbinom(0:10, size=10, prob=0.5),
  p_value = "p = 0.5"
)

df2 <- data.frame(
  outcome = 0:10,
  probability = dbinom(0:10, size=10, prob=0.8),
  p_value = "p = 0.8"
)

df <- rbind(df1, df2)

ggplot(df, aes(x=factor(outcome), y=probability)) +
  geom_segment(aes(xend=factor(outcome), yend=0), color='black') +
  geom_point(color="red", size=2) +
  labs(y = "Probability", x = "Outcome") +
  theme(legend.position="none") +
  facet_wrap(~p_value, ncol=2, scales = "free_x")

```


```{exercise, name = "Poisson intuition 1"}
Below are shown 3 different graphs of the Poisson distribution. Your task 
is to replicate them on your own in R by varying the $\lambda$ parameter.

Hint: You can use dpois() to get the probabilities.
```

```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)
library(gridExtra)

x = 0:15

# Create Poisson data
data1 <- data.frame(x = x, y = dpois(x, lambda = 0.1))
data2 <- data.frame(x = x, y = dpois(x, lambda = 1))
data3 <- data.frame(x = x, y = dpois(x, lambda = 7.5))

# Create individual ggplot objects
plot1 <- ggplot(data1, aes(x, y)) + geom_col() +
  xlab("x") + ylab("Probability") + ylim(0,1)

plot2 <- ggplot(data2, aes(x, y)) + geom_col() +
  xlab("x") + ylab(NULL) + ylim(0,1)

plot3 <- ggplot(data3, aes(x, y)) + geom_col() +
  xlab("x") + ylab(NULL) + ylim(0,1)

# Combine the plots
grid.arrange(plot1, plot2, plot3, ncol = 3)
```

<div class="fold">
```{r, echo = tog_ex, eval=FALSE}
library(ggplot2)
library(gridExtra)

x = 0:15

# Create Poisson data
data1 <- data.frame(x = x, y = dpois(x, lambda = 0.1))
data2 <- data.frame(x = x, y = dpois(x, lambda = 1))
data3 <- data.frame(x = x, y = dpois(x, lambda = 7.5))

# Create individual ggplot objects
plot1 <- ggplot(data1, aes(x, y)) + geom_col() +
  xlab("x") + ylab("Probability") + ylim(0,1)

plot2 <- ggplot(data2, aes(x, y)) + geom_col() +
  xlab("x") + ylab(NULL) + ylim(0,1)

plot3 <- ggplot(data3, aes(x, y)) + geom_col() +
  xlab("x") + ylab(NULL) + ylim(0,1)

# Combine the plots
grid.arrange(plot1, plot2, plot3, ncol = 3)
```
</div>


```{exercise, name = "Poisson intuition 2"}
The Poisson distribution is a discrete probability distribution that models 
processes where events occur at a constant mean rate and are independent of each other.

It has a single parameter $\lambda$, which represents the constant mean rate.

A classic example of a scenario that can be modeled using the Poisson distribution 
is the number of calls received by a call center in a day (or in fact any other
                                                           time interval).

Suppose you work in a call center and have some understanding of probability 
distributions. You overhear your supervisor mentioning that the call center 
receives an average of 2.5 calls per day. Using your knowledge of the Poisson 
distribution, calculate:
  
a. The probability you will get no calls today.
b. The probability you will get more than 5 calls today.
```

<div class="fold">
```{solution, echo = togs}

First recall the Poisson pmf: $$p(k) = \frac{\lambda^k e^{-\lambda}}{k!}$$
  
 as stated previously our parameter $\lambda = 2.5$

a. To get the probability of no calls we simply plug in $k = 0$, so: $$p(0) = \frac{2.5^0 e^{-2.5}}{0!} = e^{-2.5} \approx 0.082$$
  
b. The support of the Poisson distribution is non-negative integers. So if we wanted
to calculate the probability of getting more than 5 calls we would need to add up 
the probabilities of getting 6 calls and 7 calls and so on up to infinity.
Let us instead remember that the sum of all probabilties will be 1, we will
reverse the problem and instead ask "What is the probability we get 5 calls or less?".
We can subtract the probability of the opposite outcome (the complement) from 1
to get the probability of our original question.

 $$P(k > 5) = 1 - P(k \leq 5)$$
  $$P(k \leq 5) = \sum_{i=0}^{5} p(i) = p(0) + p(1) + p(2) + p(3) + p(4) + p(5) =$$
  $$= \frac{2.5^0 e^{-2.5}}{0!} + \frac{2.5^1 e^{-2.5}}{1!} + \dots =$$
  $$=0.957979$$

  So the probability of geting more than 5 calls will be $1 - 0.957979 = 0.042021$
```
</div>

```{exercise, name = "Geometric intuition 1"}
The geometric distribution is a discrete distribution that models the **number of
failures** before the first success in a sequence of independent Bernoulli trials.
It has a single parameter $p$, representing the probability of success.

*Disclaimer*: There are two forms of this distribution, the one we just described 
and another version that models the **number of trials** before the first success. The
difference is subtle yet significant and you are likely to encounter both forms, 
though here we will limit ourselves to the former.

In the graph below we show the pmf of a geometric distribution with $p=0.5$. This
can be thought of as the number of successive failures (tails) in the flip of a fair coin.
You can see that there's a 50% chance you will have zero failures i.e. you will 
flip a heads on your very first attempt. But there is some smaller chance that you
will flip a sequence of tails in a row, with longer sequences having ever lower 
probability.

a) Create an equivalent graph that represents the probability of rolling a 6 with a fair 6-sided die.
b) Use the formula for the [mean](#distributions) of the geometric distribution and determine the average number of **failures** before you roll a 6.
c) Look up the alternative form of the geometric distribtuion and again use the formula for the mean to determine the average number of **trials** before you roll a 6.

```

```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)

# Parameters
p <- 0.5
x_vals <- 0:9  # Starting from 0
probs <- dgeom(x_vals, p)

# Data
data <- data.frame(x_vals, probs)

# Plot
ggplot(data, aes(x=x_vals, y=probs)) +
  geom_segment(aes(xend=x_vals, yend=0), color="black", size=1) +
  geom_point(color="red", size=2) + 
  labs(x = "Number of trials", y = "Probability") +
  theme_minimal() +
  scale_x_continuous(breaks = x_vals) # This line ensures integer x-axis labels

```

<div class="fold">
```{solution, echo = togs}
Parameter p (the probability of success) for rolling a 6 is $p=\frac{1}{6}$.

a)

```
```{r, echo=TRUE, warning=FALSE, message=FALSE}
library(ggplot2)

# Parameters
p <- 1/6
x_vals <- 0:9  # Starting from 0
probs <- dgeom(x_vals, p)

# Data
data <- data.frame(x_vals, probs)

# Plot
ggplot(data, aes(x=x_vals, y=probs)) +
  geom_segment(aes(xend=x_vals, yend=0), color="black", size=1) +
  geom_point(color="red", size=2) + 
  labs(x = "Number of trials", y = "Probability") +
  theme_minimal() +
  scale_x_continuous(breaks = x_vals) # This line ensures integer x-axis labels

```
```{solution, echo = togs}
b) The expected value of a random variable (the mean) is denoted as $E[X]$.

$$E[X] = \frac{1-p}{p}= \frac{1- \frac{1}{6}}{\frac{1}{6}} = \frac{5}{6}\cdot 6 = 5$$
  On average we will fail 5 times before we roll our first 6.

c) The alternative form of this distribution (with support on all positive integers) has a slightly different formula for the mean. This change reflects the difference in the way we posed our question:
  
  $$E[X] = \frac{1}{p} = \frac{1}{\frac{1}{6}} = 6$$
    On average we will have to throw the die 6 times before we roll a 6.
```
</div>

## Continuous distributions 

```{exercise, name = "Uniform intuition 1"}
The need for a randomness is a common problem. A practical solution are so-called random number generators (RNGs). The simplest RNG one would think of is choosing a set of numbers and having the generator return a number at random, where the probability of returning any number from this set is the same. If this set is an interval of real numbers, then we've basically described the continuous uniform distribution.

It has two parameters $a$ and $b$, which define the beginning and end of its support respectively.

a) Let's think of the mean intuitively. The expected value or mean of a distribution is the pivot point on our x-axis, which "balances" the graph. Given parameters $a$ and $b$ what is your intuitive guess of the mean for this distribution?
b) A special case of the uniform distribution is the **standard uniform distribution** with $a=0$,$b=1$. Write the pdf of this particular case.
```
```{r, fig.width=5, fig.height=3, echo=FALSE, warning=FALSE, message=FALSE}
# Load required libraries
library(ggplot2)

# Create data for a uniform distribution
df <- data.frame(x = c("a", "b"), y = c(1, 1))

# Plot
p <- ggplot(df, aes(x, y)) +
  geom_line(aes(group = 1), color = "blue") +
  geom_point(size = 2) +
  geom_segment(aes(x = "a", xend = "a", y = 0, yend = 1), linetype = "dotted") +
  geom_segment(aes(x = "b", xend = "b", y = 0, yend = 1), linetype = "dotted") +
  labs(x = "Value", y = "Density", title = "Uniform Distribution") +
  theme_minimal() +
  theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank()) +
  annotate("text", x = "a", y = 1, label = "1/(b-a)", hjust = 1.2, vjust = 0.5) +  
  annotate("text", x = "a", y = 0, label = "0", hjust = 1.5, vjust = 0.5)

print(p)
```
<div class="fold">
```{solution, echo = togs}
a. It's the midpoint between $a$ and $b$, so $\frac{b-a}{2}$
b. Inserting the parameter values we get:$$f(x) = 
\begin{cases} 
1 & \text{if } 0 \leq x \leq 1 \\
0 & \text{otherwise}
\end{cases}
$$
Notice how the pdf is just a constant $1$ across all values of $x \in [0,1]$. Here it is important to distinguish between probability and **probability density**. The density may be 1, but the probability is not and while discreet distributions never exceeded 1 on the y-axis, continuous distributions can go as high as you like.
```
</div>


```{exercise, name = "Normal intuition 1"}
a
```

```{exercise, name = "Beta intuition 1"}
The beta distribution is a continuous distribution defined on the unit interval $[0,1]$. It has two strictly positive paramters $\alpha$ and $\beta$, which determine its shape. Its support makes it especially suitable to model distribtuions of percentages and proportions.

Below you've been provided with some code that you can copy into Rstudio. Once you run the code, an interactive Shiny app will appear and you will be able to manipulate the graph of the beta distribution.

Play around with the parameters to get:

a) A straight line from (0,0) to (1,2)
b) A straight line from (0,2) to (1,0)
c) A symmetric bell curve
d) A bowl-shaped curve
e) The standard uniform distribution is actually a special case of the beta distribution. Find the exact parameters $\alpha$ and $\beta$. Once you do, prove the equality by inserting the values into our pdf. 

*Hint*: The beta function is evaluated as $\text{B}(a,b) = \frac{\Gamma(a)\Gamma(b)}{\Gamma(a+b)}$,
 the gamma function for **positive integers** $n$ is evaluated as $\Gamma(n)= (n-1)!$
```

```
# Install and load necessary packages
install.packages(c("shiny", "ggplot2"))
library(shiny)
library(ggplot2)

# The Shiny App
ui <- fluidPage(
  titlePanel("Beta Distribution Viewer"),
  
  sidebarLayout(
    sidebarPanel(
      sliderInput("alpha", "Alpha:", min = 0.1, max = 10, value = 2, step = 0.1),
      sliderInput("beta", "Beta:", min = 0.1, max = 10, value = 2, step = 0.1)
    ),
    
    mainPanel(
      plotOutput("betaPlot")
    )
  )
)

server <- function(input, output) {
  output$betaPlot <- renderPlot({
    x <- seq(0, 1, by = 0.01)
    y <- dbeta(x, shape1 = input$alpha, shape2 = input$beta)
    
    ggplot(data.frame(x = x, y = y), aes(x = x, y = y)) +
      geom_line() +
      labs(x = "Value", y = "Density") +
      theme_minimal()
  })
}

shinyApp(ui = ui, server = server)

```
<div class="fold">
```{solution, echo = togs}
  a) $\alpha = 2, \beta=1$
  
  b) $\alpha = 1, \beta=2$
  
  c) Possible solution $\alpha = \beta= 5$
  
  d) Possible solution $\alpha = \beta= 0.5$
    
  e) The correct parameters are $\alpha = 1, \beta=1$, to prove the equality we insert them into the beta pdf:
    $$\frac{x^{\alpha - 1} (1 - x)^{\beta - 1}}{\text{B}(\alpha, \beta)} =
      \frac{x^{1 - 1} (1 - x)^{1 - 1}}{\text{B}(1, 1)} =
        \frac{1}{\frac{\Gamma(1)\Gamma(1)}{\Gamma(1+1)}}=
          \frac{1}{\frac{(1-1)!(1-1)!}{(2-1)!}} = 1$$
```
</div>


```{exercise, name = "Gamma intuition 1"}
a
```

```{exercise, name = "Exponential intuition 1"}
a
```

