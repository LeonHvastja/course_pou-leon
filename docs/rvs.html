<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 4 Random variables | Principles of Uncertainty – exercises</title>
  <meta name="description" content="Course notes">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 4 Random variables | Principles of Uncertainty – exercises" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://fri-datascience.github.io/course_pou/" />
  
  <meta property="og:description" content="Course notes" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Random variables | Principles of Uncertainty – exercises" />
  
  <meta name="twitter:description" content="Course notes" />
  

<meta name="author" content="Gregor Pirš and Erik Štrumbelj">


<meta name="date" content="2019-06-18">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="condprob.html">
<link rel="next" href="r-programming-language.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Principles of uncertainty</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Probability spaces</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#measure-and-probability-spaces"><i class="fa fa-check"></i><b>1.1</b> Measure and probability spaces</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#properties-of-probability-measures"><i class="fa fa-check"></i><b>1.2</b> Properties of probability measures</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#discrete-probability-spaces"><i class="fa fa-check"></i><b>1.3</b> Discrete probability spaces</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="uprobspaces.html"><a href="uprobspaces.html"><i class="fa fa-check"></i><b>2</b> Uncountable probability spaces</a><ul>
<li class="chapter" data-level="2.1" data-path="uprobspaces.html"><a href="uprobspaces.html#borel-sets"><i class="fa fa-check"></i><b>2.1</b> Borel sets</a></li>
<li class="chapter" data-level="2.2" data-path="uprobspaces.html"><a href="uprobspaces.html#lebesgue-measure"><i class="fa fa-check"></i><b>2.2</b> Lebesgue measure</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="condprob.html"><a href="condprob.html"><i class="fa fa-check"></i><b>3</b> Conditional probability</a><ul>
<li class="chapter" data-level="3.1" data-path="condprob.html"><a href="condprob.html#calculating-conditional-probabilities"><i class="fa fa-check"></i><b>3.1</b> Calculating conditional probabilities</a></li>
<li class="chapter" data-level="3.2" data-path="condprob.html"><a href="condprob.html#conditional-independence"><i class="fa fa-check"></i><b>3.2</b> Conditional independence</a></li>
<li class="chapter" data-level="3.3" data-path="condprob.html"><a href="condprob.html#monty-hall-problem"><i class="fa fa-check"></i><b>3.3</b> Monty Hall problem</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="rvs.html"><a href="rvs.html"><i class="fa fa-check"></i><b>4</b> Random variables</a><ul>
<li class="chapter" data-level="4.1" data-path="rvs.html"><a href="rvs.html#identifying-random-variables"><i class="fa fa-check"></i><b>4.1</b> Identifying random variables</a></li>
<li class="chapter" data-level="4.2" data-path="rvs.html"><a href="rvs.html#discrete-random-variables"><i class="fa fa-check"></i><b>4.2</b> Discrete random variables</a></li>
<li class="chapter" data-level="4.3" data-path="rvs.html"><a href="rvs.html#continuous-random-variables"><i class="fa fa-check"></i><b>4.3</b> Continuous random variables</a></li>
<li class="chapter" data-level="4.4" data-path="rvs.html"><a href="rvs.html#transformations"><i class="fa fa-check"></i><b>4.4</b> Transformations</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="r-programming-language.html"><a href="r-programming-language.html"><i class="fa fa-check"></i><b>A</b> R programming language</a><ul>
<li class="chapter" data-level="A.1" data-path="r-programming-language.html"><a href="r-programming-language.html#basic-characteristics"><i class="fa fa-check"></i><b>A.1</b> Basic characteristics</a></li>
<li class="chapter" data-level="A.2" data-path="r-programming-language.html"><a href="r-programming-language.html#why-r"><i class="fa fa-check"></i><b>A.2</b> Why R?</a></li>
<li class="chapter" data-level="A.3" data-path="r-programming-language.html"><a href="r-programming-language.html#setting-up"><i class="fa fa-check"></i><b>A.3</b> Setting up</a><ul>
<li class="chapter" data-level="A.3.1" data-path="r-programming-language.html"><a href="r-programming-language.html#rstudio"><i class="fa fa-check"></i><b>A.3.1</b> RStudio</a></li>
<li class="chapter" data-level="A.3.2" data-path="r-programming-language.html"><a href="r-programming-language.html#libraries-for-data-science"><i class="fa fa-check"></i><b>A.3.2</b> Libraries for data science</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="r-programming-language.html"><a href="r-programming-language.html#r-basics"><i class="fa fa-check"></i><b>A.4</b> R basics</a><ul>
<li class="chapter" data-level="A.4.1" data-path="r-programming-language.html"><a href="r-programming-language.html#variables-and-types"><i class="fa fa-check"></i><b>A.4.1</b> Variables and types</a></li>
<li class="chapter" data-level="A.4.2" data-path="r-programming-language.html"><a href="r-programming-language.html#basic-operations"><i class="fa fa-check"></i><b>A.4.2</b> Basic operations</a></li>
<li class="chapter" data-level="A.4.3" data-path="r-programming-language.html"><a href="r-programming-language.html#vectors"><i class="fa fa-check"></i><b>A.4.3</b> Vectors</a></li>
<li class="chapter" data-level="A.4.4" data-path="r-programming-language.html"><a href="r-programming-language.html#factors"><i class="fa fa-check"></i><b>A.4.4</b> Factors</a></li>
<li class="chapter" data-level="A.4.5" data-path="r-programming-language.html"><a href="r-programming-language.html#matrices"><i class="fa fa-check"></i><b>A.4.5</b> Matrices</a></li>
<li class="chapter" data-level="A.4.6" data-path="r-programming-language.html"><a href="r-programming-language.html#arrays"><i class="fa fa-check"></i><b>A.4.6</b> Arrays</a></li>
<li class="chapter" data-level="A.4.7" data-path="r-programming-language.html"><a href="r-programming-language.html#data-frames"><i class="fa fa-check"></i><b>A.4.7</b> Data frames</a></li>
<li class="chapter" data-level="A.4.8" data-path="r-programming-language.html"><a href="r-programming-language.html#lists"><i class="fa fa-check"></i><b>A.4.8</b> Lists</a></li>
<li class="chapter" data-level="A.4.9" data-path="r-programming-language.html"><a href="r-programming-language.html#loops"><i class="fa fa-check"></i><b>A.4.9</b> Loops</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="r-programming-language.html"><a href="r-programming-language.html#functions"><i class="fa fa-check"></i><b>A.5</b> Functions</a><ul>
<li class="chapter" data-level="A.5.1" data-path="r-programming-language.html"><a href="r-programming-language.html#writing-functions"><i class="fa fa-check"></i><b>A.5.1</b> Writing functions</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="r-programming-language.html"><a href="r-programming-language.html#other-tips"><i class="fa fa-check"></i><b>A.6</b> Other tips</a></li>
<li class="chapter" data-level="A.7" data-path="r-programming-language.html"><a href="r-programming-language.html#further-reading-and-references"><i class="fa fa-check"></i><b>A.7</b> Further reading and references</a></li>
<li class="chapter" data-level="A.8" data-path="r-programming-language.html"><a href="r-programming-language.html#learning-outcomes"><i class="fa fa-check"></i><b>A.8</b> Learning outcomes</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="probability-distributions.html"><a href="probability-distributions.html"><i class="fa fa-check"></i><b>B</b> Probability distributions</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>      
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Principles of Uncertainty – exercises</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rvs" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Random variables</h1>
<p>This chapter deals with random variables.</p>
<p>The students are expected to acquire the following knowledge:</p>
<p><strong>Theoretical</strong></p>
<ul>
<li></li>
</ul>
<p><strong>R</strong></p>
<ul>
<li>sampling from distributions</li>
<li>calculating PDF, CDF, and quantile functions</li>
<li>plotting results</li>
<li>facet wrap</li>
</ul>
<div id="identifying-random-variables" class="section level2">
<h2><span class="header-section-number">4.1</span> Identifying random variables</h2>

<div class="exercise">
<p><span id="exr:unnamed-chunk-2" class="exercise"><strong>Exercise 1.1  </strong></span>Which of the functions below are valid CDFs? Find their respective densities.
<span style="color:blue">R: Plot the three functions.</span></p>
<ol style="list-style-type: lower-alpha">
<li><p><span class="math display">\[\begin{equation}
  F(x) = \begin{cases}
         1 - e^{-x^2} &amp; x \geq 0    \\
         0 &amp; x &lt; 0.
       \end{cases}
\end{equation}\]</span></p></li>
<li><p><span class="math display">\[\begin{equation}
  F(x) = \begin{cases}
        e^{-\frac{1}{x}} &amp; x &gt; 0    \\
         0 &amp; x \leq 0.
       \end{cases}
\end{equation}\]</span></p></li>
<li><p><span class="math display">\[\begin{equation}
  F(x) = \begin{cases}
        0 &amp; x \leq 0 \\
        \frac{1}{3} &amp; 0 &lt; x \leq \frac{1}{2} \\
        1 &amp; x &gt; \frac{1}{2}.
      \end{cases}
\end{equation}\]</span></p></li>
</ol>
</div>


<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> </p>
<ol style="list-style-type: lower-alpha">
<li>Yes.</li>
</ol>
<ul>
<li>First, let us check the limits.
<span class="math inline">\(\lim_{x \rightarrow -\infty} (0) = 0\)</span>.
<span class="math inline">\(\lim_{x \rightarrow \infty} (1 - e^{-x^2}) = 1 - \lim_{x \rightarrow \infty} e^{-x^2} = 1 - 0 = 1\)</span>.</li>
<li>Second, let us check whether the function is increasing. Let <span class="math inline">\(x &gt; y \geq 0\)</span>.
Then <span class="math inline">\(1 - e^{-x^2} \geq 1 - e^{-y^2}\)</span>.</li>
<li>We only have to check right continuity for the point zero. <span class="math inline">\(F(0) = 0\)</span> and
<span class="math inline">\(\lim_{\epsilon \downarrow 0}F (0 + \epsilon) =  \lim_{\epsilon \downarrow 0} 1 - e^{-\epsilon^2} =  1 - \lim_{\epsilon \downarrow 0} e^{-\epsilon^2} =  1 - 1 = 0\)</span>.
<ul>
<li>We get the density by differentiating the CDF.
<span class="math inline">\(p(x) = \frac{d}{dx} 1 - e^{-x^2} = 2xe^{-x^2}.\)</span> Students are encouraged to
check that this is a proper PDF.</li>
</ul></li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li>Yes.</li>
</ol>
<ul>
<li>First, let us check the limits.
$_{x -} (0) = 0 and
<span class="math inline">\(\lim_{x \rightarrow \infty} (e^{-\frac{1}{x}}) = 1\)</span>.</li>
<li>Second, let us check whether the function is increasing. Let <span class="math inline">\(x &gt; y \geq 0\)</span>.
Then <span class="math inline">\(e^{-\frac{1}{x}} \geq e^{-\frac{1}{y}}\)</span>.</li>
<li>We only have to check right continuity for the point zero. <span class="math inline">\(F(0) = 0\)</span> and
<span class="math inline">\(\lim_{\epsilon \downarrow 0}F (0 + \epsilon) =  \lim_{\epsilon \downarrow 0} e^{-\frac{1}{\epsilon}} = 0\)</span>.</li>
<li>We get the density by differentiating the CDF.
<span class="math inline">\(p(x) = \frac{d}{dx} e^{-\frac{1}{x}} = \frac{1}{x^2}e^{-\frac{1}{x}}.\)</span>
Students are encouraged to
check that this is a proper PDF.</li>
</ul>
<ol start="3" style="list-style-type: lower-alpha">
<li>No. The function is not right continuous as <span class="math inline">\(F(\frac{1}{2}) = \frac{1}{3}\)</span>,
but <span class="math inline">\(\lim_{\epsilon \downarrow 0} F(\frac{1}{2} + \epsilon) = 1\)</span>.</li>
</ol>
</div>

<pre class="sourceCode r"><code class="sourceCode r">f1 &lt;-<span class="st"> </span><span class="cf">function</span> (x) {
  tmp        &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)
  tmp[x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">0</span>
  <span class="kw">return</span>(tmp)
}

f2 &lt;-<span class="st"> </span><span class="cf">function</span> (x) {
  tmp         &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>x))
  tmp[x <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">0</span>
  <span class="kw">return</span>(tmp)
}

f3 &lt;-<span class="st"> </span><span class="cf">function</span> (x) {
  tmp           &lt;-<span class="st"> </span>x
  tmp[x <span class="op">==</span><span class="st"> </span>x]   &lt;-<span class="st"> </span><span class="dv">1</span>
  tmp[x <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.5</span>] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">3</span>
  tmp[x <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>]   &lt;-<span class="st"> </span><span class="dv">0</span>
  <span class="kw">return</span>(tmp)
}

cdf_data &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x  =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">20</span>, <span class="dt">by =</span> <span class="fl">0.001</span>),
                   <span class="dt">f1 =</span> <span class="kw">f1</span>(x),
                   <span class="dt">f2 =</span> <span class="kw">f2</span>(x),
                   <span class="dt">f3 =</span> <span class="kw">f3</span>(x)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">melt</span>(<span class="dt">id.vars =</span> <span class="st">&quot;x&quot;</span>)

<span class="co"># geo_plot &lt;- ggplot(data = data.frame(x = seq(-1, 10, by = 0.01)), aes(x = x)) +</span>
<span class="co">#   stat_function(aes(color = &quot;f1&quot;), fun = f1) +</span>
<span class="co">#   stat_function(aes(color = &quot;f2&quot;), fun = f2) +</span>
<span class="co">#   stat_function(aes(color = &quot;f3&quot;), fun = f3) +</span>
<span class="co">#   geom_hline(yintercept = 1)</span>
<span class="co"># plot(geo_plot)</span>

cdf_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> cdf_data, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> value, <span class="dt">color =</span> variable)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>()
<span class="kw">plot</span>(cdf_plot)</code></pre>
<p><img src="04-random_variables_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-5" class="exercise"><strong>Exercise 4.1  </strong></span>Let <span class="math inline">\(X\)</span> be a random variable with CDF
<span class="math display">\[\begin{equation}
  F(x) = \begin{cases}
            0 &amp; x &lt; 0 \\
            \frac{x^2}{2} &amp; 0 \leq x &lt; 1 \\
            \frac{1}{2} + \frac{p}{2} &amp; 1 \leq x &lt; 2 \\
            \frac{1}{2} + \frac{p}{2} + \frac{1 - p}{2} &amp; x \geq 2
          \end{cases}
\end{equation}\]</span></p>
<ol style="list-style-type: lower-alpha">
<li><p><span style="color:blue">R: Plot this CDF for <span class="math inline">\(p = 0.3\)</span>. Is it a discrete,
continuous, or mixed random
varible?</span></p></li>
<li>Find the probability density/mass of <span class="math inline">\(X\)</span>.</li>
</ol>
</div>

<pre class="sourceCode r"><code class="sourceCode r">f1 &lt;-<span class="st"> </span><span class="cf">function</span> (x, p) {
  tmp          &lt;-<span class="st"> </span>x
  tmp[x <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2</span>]  &lt;-<span class="st"> </span><span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>(p <span class="op">*</span><span class="st"> </span><span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span>((<span class="dv">1</span><span class="op">-</span>p) <span class="op">*</span><span class="st"> </span><span class="fl">0.5</span>)
  tmp[x <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>]   &lt;-<span class="st"> </span><span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>(p <span class="op">*</span><span class="st"> </span><span class="fl">0.5</span>) 
  tmp[x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>]   &lt;-<span class="st"> </span>(x[x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>])<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>
  tmp[x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>]   &lt;-<span class="st"> </span><span class="dv">0</span>
  <span class="kw">return</span>(tmp)
}

cdf_data &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="dt">by =</span> <span class="fl">0.001</span>), <span class="dt">y =</span> <span class="kw">f1</span>(x, <span class="fl">0.3</span>))
cdf_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> cdf_data, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)
<span class="kw">plot</span>(cdf_plot)</code></pre>
<img src="04-random_variables_files/figure-html/unnamed-chunk-6-1.png" width="672" />

<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> </p>
<ol style="list-style-type: lower-alpha">
<li><p><span class="math inline">\(X\)</span> is a mixed random variable.</p></li>
<li>Since <span class="math inline">\(X\)</span> is a mixed random variable, we have to find the PDF of the
continuous part and the PMF of the discrete part. We get the continuous
part by differentiating the corresponding CDF, <span class="math inline">\(\frac{d}{dx}\frac{x^2}{2} = x\)</span>.
So the PDF, when <span class="math inline">\(0 \leq x &lt; 1\)</span>, is <span class="math inline">\(p(x) = x\)</span>. Let us look at the discrete
part now. It has two steps, so this is a discrete distribution with two
outcomes – numbers two and three. The first happens with probability
<span class="math inline">\(\frac{p}{2}\)</span>, and the second with probability <span class="math inline">\(\frac{1 - p}{2}\)</span>. This reminds
us of the bernoulli distribution, the only difference is that the probabilities
of outcomes are halved, as they need to be suitably normalized. So the PMF
for the discrete part is <span class="math inline">\(P(X = x) = (\frac{p}{2})^{2 - \lfloor x \rfloor} (\frac{1 - p}{2})^{\lfloor x \rfloor - 1}\)</span>.
</div></li>
</ol>
</div>
<div id="discrete-random-variables" class="section level2">
<h2><span class="header-section-number">4.2</span> Discrete random variables</h2>

<div class="exercise">
<p><span id="exr:bincdf" class="exercise"><strong>Exercise 4.2  (Binomial random variable)  </strong></span>Let <span class="math inline">\(X_k\)</span>, <span class="math inline">\(k = 1,...,n\)</span>, be random variables with the Bernoulli measure as the
PMF with <span class="math inline">\(p = 0.4\)</span>. Let <span class="math inline">\(X = \sum_{k=1}^n\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li><p>We call <span class="math inline">\(X_k\)</span> a Bernoulli random variable. Find the CDF of <span class="math inline">\(X_k\)</span>.</p></li>
<li><p>Find PDF of <span class="math inline">\(X\)</span>.</p></li>
<li><p>Find CDF of <span class="math inline">\(X\)</span>.</p></li>
<li><span style="color:blue">R: Simulate from the binomial distribution
with <span class="math inline">\(n = 10\)</span> and <span class="math inline">\(p = 0.5\)</span>, and from <span class="math inline">\(n\)</span> Bernoulli distributions with
<span class="math inline">\(p = 0.5\)</span>. Visually compare the sum of Bernoullis and the binomial. Hint:
there is no standard function like <em>rpois</em> for a Bernoulli random
variable. Check exercise <a href="introduction.html#exr:binomialpmf">1.11</a> to find out how to sample
from a Bernoulli
distribution.</span></li>
</ol>
</div>


<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> </p>
<ol style="list-style-type: lower-alpha">
<li><p>There are two outcomes – zero and one. Zero happens with probability
<span class="math inline">\(1 - p\)</span>. Therefore
<span class="math display">\[\begin{equation}
  F(k) = \begin{cases}
         0 &amp; k &lt; 0 \\
         1 - p &amp; 0 \leq k &lt; 1 \\
         1 &amp; k \geq 1.
       \end{cases}
\end{equation}\]</span></p></li>
<li><p>For the probability of <span class="math inline">\(X\)</span> to be equal to some <span class="math inline">\(k \leq n\)</span>, exactly <span class="math inline">\(k\)</span>
Bernoulli variables need to be one, and the others zero. So <span class="math inline">\(p^k(1-p)^{n-k}\)</span>.
There are <span class="math inline">\(\binom{n}{k}\)</span> such possible arrangements. Therefore
<span class="math display">\[\begin{align}
  P(X = k) = P(\sum X_k = 2) = \binom{n}{k} p^k (1 - p)^{n-k}.
\end{align}\]</span></p></li>
<li><span class="math display">\[\begin{equation}
  F(k) = \sum_{i = 1}^{\lfloor k \rfloor} \binom{n}{i} p^i (1 - p)^{n - i}
\end{equation}\]</span><br />

</div></li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
nsamps        &lt;-<span class="st"> </span><span class="dv">10000</span>
binom_samp    &lt;-<span class="st"> </span><span class="kw">rbinom</span>(nsamps, <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">prob =</span> <span class="fl">0.5</span>)
bernoulli_mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="ot">NA</span>, <span class="dt">nrow =</span> nsamps, <span class="dt">ncol =</span> <span class="dv">10</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nsamps) {
  bernoulli_mat[i, ] &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">10</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="fl">0.5</span>)
}
bern_samp &lt;-<span class="st"> </span><span class="kw">apply</span>(bernoulli_mat, <span class="dv">1</span>, sum)
b_data    &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x    =</span> <span class="kw">c</span>(binom_samp, bern_samp), 
                    <span class="dt">type =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;binomial&quot;</span>, <span class="dv">10000</span>), <span class="kw">rep</span>(<span class="st">&quot;Bernoulli_sum&quot;</span>, <span class="dv">10000</span>)))
b_plot    &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> b_data, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">fill =</span> type)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)
<span class="kw">plot</span>(b_plot)</code></pre>
<p><img src="04-random_variables_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>

<div class="exercise">
<p><span id="exr:geocdf" class="exercise"><strong>Exercise 4.3  (Geometric random variable)  </strong></span>A variable with PMF <span class="math inline">\(p(1-p)^k\)</span> is a geometric random
variable with support in non-negative integers. It has one positive parameter
<span class="math inline">\(p\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Derive the CDF of a geometric random variable.</p></li>
<li><span style="color:blue">R: Draw 1000 samples from the geometric
distribution with <span class="math inline">\(p\)</span> = 0.3$ and compare their frequencies to
theoretical values.</span></li>
</ol>
</div>


<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> </p>
<ol style="list-style-type: lower-alpha">
<li><span class="math display">\[\begin{align}
P(X \leq k) &amp;= \sum_{i = 0}^k p(1-p)^i \\
          &amp;= p \sum_{i = 0}^k (1-p)^i \\
          &amp;= p \frac{1 - (1-p)^{k+1}}{1 - (1 - p)} \\
          &amp;= 1 - (1-p)^{k + 1}
\end{align}\]</span></li>
</ol>
</div>

<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
geo_samp &lt;-<span class="st"> </span><span class="kw">rgeom</span>(<span class="dt">n =</span> <span class="dv">1000</span>, <span class="dt">prob =</span> <span class="fl">0.3</span>)
geo_samp &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> geo_samp) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">count</span>(x) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n =</span> n <span class="op">/</span><span class="st"> </span><span class="dv">1000</span>, <span class="dt">type =</span> <span class="st">&quot;empirical_frequencies&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">bind_rows</span>(<span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">20</span>, <span class="dt">n =</span> <span class="kw">dgeom</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">20</span>, <span class="dt">prob =</span> <span class="fl">0.3</span>), <span class="dt">type =</span> <span class="st">&quot;theoretical_measure&quot;</span>))

geo_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> geo_samp, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> n, <span class="dt">fill =</span> type)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)
<span class="kw">plot</span>(geo_plot)</code></pre>
<p><img src="04-random_variables_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-12" class="exercise"><strong>Exercise 1.6  (Poisson random variable)  </strong></span>A variable with PMF <span class="math inline">\(\frac{\lambda^k e^{-\lambda}}{k!}\)</span> is a Poisson random
variable with support in non-negative integers. It has one positive parameter
<span class="math inline">\(\lambda\)</span>,
which also represents its mean value and variance (a measure of the deviation
of the values from the mean – more on mean and variance in the next chapter).
This distribution is usually the default choice for modeling counts. We have
already encountered a Poisson random variable in exercise <a href="introduction.html#exr:geopoispmf">1.12</a>,
where we also sampled from this distribution.</p>
<p>The CDF of a Poisson random variable is <span class="math inline">\(P(X &lt;= x) = e^{-\lambda} \sum_{i=0}^x \frac{\lambda^{i}}{i!}\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li><span style="color:blue">R: Draw 1000 samples from the Poisson
distribution with <span class="math inline">\(p\)</span> = 0.3$ and compare their empirical cumulative
distribution function with the theoretical CDF.</span></li>
</ol>
</div>

<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
pois_samp &lt;-<span class="st"> </span><span class="kw">rpois</span>(<span class="dt">n =</span> <span class="dv">1000</span>, <span class="dt">lambda =</span> <span class="dv">5</span>)
pois_samp &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> pois_samp)
pois_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> pois_samp, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">colour =</span> <span class="st">&quot;ECDF&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_ecdf</span>(<span class="dt">geom =</span> <span class="st">&quot;step&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_step</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">x =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">17</span>, <span class="dt">y =</span> <span class="kw">ppois</span>(x, <span class="dv">5</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">colour =</span> <span class="st">&quot;CDF&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="co"># stat_function(data = data.frame(x = 0:17), aes(x = x, colour = &quot;CDF&quot;), geom = &quot;line&quot;, fun = ppois, args = list(lambda = 5)) +</span>
<span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="st">&quot;Lgend title&quot;</span>, <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>))
<span class="kw">plot</span>(pois_plot)</code></pre>
<p><img src="04-random_variables_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="continuous-random-variables" class="section level2">
<h2><span class="header-section-number">4.3</span> Continuous random variables</h2>

<div class="exercise">
<p><span id="exr:expcdf" class="exercise"><strong>Exercise 4.4  (Exponential random variable)  </strong></span>A variable <span class="math inline">\(X\)</span> with PDF <span class="math inline">\(\lambda e^{-\lambda x}\)</span> is an exponential random
variable with support in non-negative real numbers. It has one positive
parameter <span class="math inline">\(\lambda\)</span>.
<span class="math display">\[\begin{equation}
  X | \lambda \sim \text{Exp}(\lambda)
\end{equation}\]</span></p>
<ol style="list-style-type: lower-alpha">
<li><p>Derive the CDF of an exponential random variable.</p></li>
<li><p>Derive the quantile function of an exponential random variable.</p></li>
<li><p>Calculate the probability <span class="math inline">\(P(1 \leq X \leq 3)\)</span>, where <span class="math inline">\(X \sim \text{Exp(1.5)}\)</span>.</p></li>
<li><p><span style="color:blue">R: Check your answer to c) with a
simulation (<em>rexp</em>). Plot the probability in a meaningful way.</span></p></li>
<li><span style="color:blue">R: Implement PDF, CDF, and the quantile
function and compare their values with corresponding R
functions visually. Hint: use BOLD line.</span></li>
</ol>
</div>


<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> </p>
<ol style="list-style-type: lower-alpha">
<li><p><span class="math display">\[\begin{align}
F(x) &amp;= \int_{0}^{x} \lambda e^{-\lambda t} dt \\
     &amp;= \lambda \int_{0}^{x} e^{-\lambda t} dt \\
     &amp;= \lambda (\frac{1}{-\lambda}e^{-\lambda t} |_{0}^{x}) \\
     &amp;= \lambda(\frac{1}{\lambda} - \frac{1}{\lambda} e^{-\lambda x}) \\
     &amp;= 1 - e^{-\lambda x}.
\end{align}\]</span></p></li>
<li><p><span class="math display">\[\begin{align}
F(F^{-1}(x))               &amp;= x \\
1 - e^{-\lambda F^{-1}(x)} &amp;= x \\
e^{-\lambda F^{-1}(x)}     &amp;= 1 - x \\
-\lambda F^{-1}(x)         &amp;= \ln(1 - x) \\
F^{-1}(x)                  &amp;= - \frac{ln(1 - x)}{\lambda}.
\end{align}\]</span></p></li>
<li><span class="math display">\[\begin{align}
  P(1 \leq X \leq 3) &amp;= P(X  \leq 3) - P(X \leq 1) \\
                  &amp;= P(X \leq 3) - P(X \leq 1) \\
                  &amp;= 1 - e^{-1.5 \times 3} - 1 + e^{-1.5 \times 1} \\
                  &amp;\approx 0.212.
\end{align}\]</span></li>
</ol>
</div>

<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
nsamps &lt;-<span class="st"> </span><span class="dv">1000</span>
samps  &lt;-<span class="st"> </span><span class="kw">rexp</span>(nsamps, <span class="dt">rate =</span> <span class="fl">1.5</span>)
<span class="kw">sum</span>(samps <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>samps <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3</span>) <span class="op">/</span><span class="st"> </span>nsamps</code></pre>
<pre><code>## [1] 0.212</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">exp_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dexp, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">rate =</span> <span class="fl">1.5</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dexp, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">rate =</span> <span class="fl">1.5</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">geom =</span> <span class="st">&quot;area&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;red&quot;</span>)
<span class="kw">plot</span>(exp_plot)</code></pre>
<p><img src="04-random_variables_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">exp_pdf &lt;-<span class="st"> </span><span class="cf">function</span>(x, lambda) {
  <span class="kw">return</span> (lambda <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>lambda <span class="op">*</span><span class="st"> </span>x))
}

exp_cdf &lt;-<span class="st"> </span><span class="cf">function</span>(x, lambda) {
  <span class="kw">return</span> (<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>lambda <span class="op">*</span><span class="st"> </span>x))
}

exp_quant &lt;-<span class="st"> </span><span class="cf">function</span>(q, lambda) {
  <span class="kw">return</span> (<span class="op">-</span>(<span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>q) <span class="op">/</span><span class="st"> </span>lambda))
}

<span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dexp, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">rate =</span> <span class="fl">1.5</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;R&quot;</span>), <span class="dt">size =</span> <span class="fl">2.5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> exp_pdf, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">lambda =</span> <span class="fl">1.5</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;Mine&quot;</span>), <span class="dt">size =</span> <span class="fl">1.2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>))</code></pre>
<p><img src="04-random_variables_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> pexp, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">rate =</span> <span class="fl">1.5</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;R&quot;</span>), <span class="dt">size =</span> <span class="fl">2.5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> exp_cdf, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">lambda =</span> <span class="fl">1.5</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;Mine&quot;</span>), <span class="dt">size =</span> <span class="fl">1.2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>))</code></pre>
<p><img src="04-random_variables_files/figure-html/unnamed-chunk-16-2.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> qexp, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">rate =</span> <span class="fl">1.5</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;R&quot;</span>), <span class="dt">size =</span> <span class="fl">2.5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> exp_quant, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">lambda =</span> <span class="fl">1.5</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;Mine&quot;</span>), <span class="dt">size =</span> <span class="fl">1.2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>))</code></pre>
<img src="04-random_variables_files/figure-html/unnamed-chunk-16-3.png" width="672" />

<div class="exercise">
<p><span id="exr:gammapdf" class="exercise"><strong>Exercise 4.5  (Gamma random variable)  </strong></span>Let <span class="math inline">\(X_i \sim \text{Exp}(\lambda), i = 1,...,n\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>Find the PDF of <span class="math inline">\(\sum_{i=1}^n X_i\)</span>.</li>
</ol>
<span style="color:red">TODO</span>
</div>


<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> </p>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
</div>

<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)</code></pre>

<div class="exercise">
<p><span id="exr:betacdf" class="exercise"><strong>Exercise 4.6  (Beta random variable)  </strong></span>A variable <span class="math inline">\(X\)</span> with PDF
<span class="math inline">\(p(x) = \frac{x^{\alpha - 1} (1 - x)^{\beta - 1}}{\text{B}(\alpha, \beta)}\)</span>,
where <span class="math inline">\(\text{B}(\alpha, \beta) = \frac{\Gamma(\alpha) \Gamma(\beta)}{\Gamma(\alpha + \beta)}\)</span> and
<span class="math inline">\(\Gamma(x) = \int_0^{\infty} x^{z - 1} e^{-x} dx\)</span>
is a Beta random
variable with support on <span class="math inline">\([0,1]\)</span>. It has two positive
parameters <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>.
<span class="math display">\[\begin{equation}
  X | \alpha, \beta \sim \text{Beta}(\alpha, \beta)
\end{equation}\]</span>
It is usually used in modeling rates.
<span style="color:red">TODO: CDF</span></p>
<ol style="list-style-type: lower-alpha">
<li><p>Calculate the PDF for <span class="math inline">\(\alpha = 1\)</span> and <span class="math inline">\(\beta = 1\)</span>. What do you notice?</p></li>
<li><p><span style="color:blue">R: Plot densities of the beta distribution
for <span class="math inline">\(\alpha = 0.5\)</span>, <span class="math inline">\(\beta = 0.5\)</span>, <span class="math inline">\(\alpha = 4\)</span>, <span class="math inline">\(\beta = 1\)</span>, <span class="math inline">\(\alpha = 1\)</span>, <span class="math inline">\(\beta = 4\)</span>, <span class="math inline">\(alpha = 0.1\)</span>, <span class="math inline">\(\beta = 0.1\)</span>.</span></p></li>
<li><span style="color:blue">R: Sample from <span class="math inline">\(X \sim \text{Beta}(2, 5)\)</span> and
compare the histogram with Beta PDF.</span></li>
</ol>
</div>


<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> </p>
<ol style="list-style-type: lower-alpha">
<li><span class="math display">\[\begin{equation}
p(x) = \frac{x^{1 - 1} (1 - x)^{1 - 1}}{\text{B}(1, 1)} = 1.
\end{equation}\]</span></li>
</ol>
</div>

<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dbeta, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="dv">2</span>, <span class="dt">shape2 =</span> <span class="dv">2</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;alpha = 0.5&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dbeta, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="dv">4</span>, <span class="dt">shape2 =</span> <span class="dv">1</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;alpha = 4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dbeta, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="dv">1</span>, <span class="dt">shape2 =</span> <span class="dv">4</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;alpha = 1&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dbeta, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="dv">2</span>, <span class="dt">shape2 =</span> <span class="dv">5</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;alpha = 25&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dbeta, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="fl">0.1</span>, <span class="dt">shape2 =</span> <span class="fl">0.1</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;alpha = 0.1&quot;</span>))</code></pre>
<p><img src="04-random_variables_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
nsamps &lt;-<span class="st"> </span><span class="dv">1000</span>
samps  &lt;-<span class="st"> </span><span class="kw">rbeta</span>(nsamps, <span class="dv">2</span>, <span class="dv">5</span>)
<span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> samps), <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..), <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">data  =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> x), 
                <span class="dt">fun   =</span> dbeta, 
                <span class="dt">args  =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="dv">2</span>, <span class="dt">shape2 =</span> <span class="dv">5</span>), 
                <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, 
                <span class="dt">size  =</span> <span class="fl">1.2</span>)</code></pre>
<p><img src="04-random_variables_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>

<div class="exercise">
<span id="exr:unifpdf" class="exercise"><strong>Exercise 4.7  (Uniform random variable)  </strong></span><span style="color:red">TODO</span>
</div>


<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> </p>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
</div>

<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)</code></pre>

<div class="exercise">
<p><span id="exr:normalpdf" class="exercise"><strong>Exercise 4.8  (Normal random variable)  </strong></span>A random variable with PDF $p(x) = $ is a normal random variable.
Many statistical methods assume a normal distribution. Due to it’s flexibility
it is also one of the most researched distributions. For that reason
statisticians often use transformations of variables or approximate
distributions with the normal distribution.</p>
<ol style="list-style-type: lower-alpha">
<li>For Poisson distributed variables with a large <span class="math inline">\(\lambda\)</span>, the normal
distribution provides a good approximation. Let <span class="math inline">\(X \sim \text{Poisson}(50)\)</span>.
Approximate <span class="math inline">\(X\)</span> with the normal distribution and compare it’s density with
the Poisson histogram. What are the values of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> that
should provide the best approximation?
</div>

<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> </p></li>
<li></li>
</ol>
</div>

<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
nsamps     &lt;-<span class="st"> </span><span class="dv">100000</span>
pois_samps &lt;-<span class="st"> </span><span class="kw">rpois</span>(nsamps, <span class="dt">lambda =</span> <span class="dv">50</span>)
norm_samps &lt;-<span class="st"> </span><span class="kw">rnorm</span>(nsamps, <span class="dt">mean =</span> <span class="dv">50</span>, <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">50</span>))
my_plot    &lt;-<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">x =</span> pois_samps), <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> (..count..)<span class="op">/</span><span class="kw">sum</span>(..count..))) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">x =</span> norm_samps), <span class="kw">aes</span>(<span class="dt">x =</span> x), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)
<span class="kw">plot</span>(my_plot)</code></pre>
<p><img src="04-random_variables_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>

<div class="exercise">
<p><span id="exr:logitpdf" class="exercise"><strong>Exercise 4.9  (Logistic random variable)  </strong></span>A logistic random variable has CDF $F(x) = ,
where <span class="math inline">\(\mu\)</span> is real and <span class="math inline">\(s &gt; 0\)</span>.
The distribution of the logistic random variable resembles a normal random
variable, however it has heavier tails.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Find the PDF of a logistic random variable.</p></li>
<li><p><span style="color:blue">R: Implement logistic PDF and CDF and visually
compare both for <span class="math inline">\(X \sim \text{N}(0, 1)\)</span> and <span class="math inline">\(Y \sim \text{logit}(0, \sqrt{\frac{3}{\pi^2}})\)</span>.</span></p></li>
<li><p>Find <span class="math inline">\(P(...)\)</span> TAIL PROBABILITIES.</p></li>
</ol>
<span style="color:red">TODO</span>
</div>


<div class="solution">
<p> <span class="solution"><em>Solution. </em></span> </p>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
</div>

<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
logit_pdf &lt;-<span class="st"> </span><span class="cf">function</span> (x, mu, s) {
  <span class="kw">return</span> ((<span class="kw">exp</span>(<span class="op">-</span>(x <span class="op">-</span><span class="st"> </span>mu)<span class="op">/</span>(s))) <span class="op">/</span><span class="st"> </span>(s <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>(x <span class="op">-</span><span class="st"> </span>mu)<span class="op">/</span>(s)))<span class="op">^</span><span class="dv">2</span>))
}
nl_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;normal&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> logit_pdf, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mu =</span> <span class="dv">0</span>, <span class="dt">s =</span> <span class="kw">sqrt</span>(<span class="dv">3</span><span class="op">/</span>pi<span class="op">^</span><span class="dv">2</span>)), <span class="kw">aes</span>(<span class="dt">color =</span> <span class="st">&quot;logit&quot;</span>))
<span class="kw">plot</span>(nl_plot)</code></pre>
<p><img src="04-random_variables_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
<div id="transformations" class="section level2">
<h2><span class="header-section-number">4.4</span> Transformations</h2>

</div>
</div>



</div>
            </section>

          </div>
        </div>
      </div>
<a href="condprob.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="r-programming-language.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
