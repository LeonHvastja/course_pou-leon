"0","set.seed(1)"
"0","nvars   <- 100"
"0","nsamps  <- 1000"
"0","samps   <- matrix(data = NA, nrow = nsamps, ncol = nvars)"
"0","Sn_mean <- 0"
"0","Sn_var  <- 0"
"0","for (i in 1:nvars) {"
"0","  alpha1  <- rgamma(1, 10, 1)"
"0","  beta1   <- rgamma(1, 10, 1)"
"0","  X       <- rbeta(nsamps, alpha1, beta1)"
"0","  Sn_mean <- Sn_mean + alpha1 / (alpha1 + beta1)"
"0","  Sn_var  <- Sn_var + "
"0","    alpha1 * beta1 / ((alpha1 + beta1)^2 * (alpha1 + beta1 + 1))"
"0","  "
"0","    samps[ ,i] <- X"
"0","}"
"0","mean(apply(samps, 1, sum))"
"1","[1]"
"1"," 51.12511"
"1","
"
"0","Sn_mean"
"1","[1]"
"1"," 51.15723"
"1","
"
"0","var(apply(samps, 1, sum))"
"1","[1]"
"1"," 1.170652"
"1","
"
"0","Sn_var"
"1","[1]"
"1"," 1.166183"
"1","
"
"0","a <- 1:30"
"0","b <- a / sqrt(Sn_var)"
"0",""
"0","ci_chebyshev <- 1 / b^2"
"0","ci_hoeffding <- 2 * exp(- 2 * a^2 / nvars)"
"0","empirical    <- NULL"
"0","for (i in 1:length(a)) {"
"0","  empirical[i] <- sum(abs((apply(samps, 1, sum)) - Sn_mean) >= a[i])/ nsamps"
"0","}"
"0",""
"0","plot_df     <- rbind("
"0","  data.frame(x = a, y = ci_chebyshev, type = ""Chebyshev""),"
"0","  data.frame(x = a, y = ci_hoeffding, type = ""Hoeffding""),"
"0","  data.frame(x = a, y = empirical, type = ""Empirical"")"
"0",")"
"0",""
"0","ggplot(plot_df, aes(x = x, y = y, color = type)) +"
"0","  geom_line()"
