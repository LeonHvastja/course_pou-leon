"0","pCantor <- function(q, lower.tail = TRUE, log.p = FALSE, bits=32){"
"0","    first1already <- logical(length(q))"
"0","    p <- numeric(length(q))"
"0","    qtest <- numeric(length(q))"
"0","    for (b in 1:bits) { "
"0","        low1  <-  (qtest +   3^(-b) < q)"
"0","        low2  <-  (qtest + 2*3^(-b) < q)"
"0","        qtest <- qtest + ifelse(low1, 3^(-b), 0) + ifelse(low2, 3^(-b), 0)"
"0","        p     <- p + ifelse(low1 & ! first1already, 2^(-b), 0)      "
"0","        first1already <- first1already | (low1 & ! low2)"
"0","        }"
"0","    #p <- p + 2^{-bits}"
"0","    p <- ifelse( q >= 1, 1, ifelse( q <= 0, 0, p ))"
"0","    if(! lower.tail){ p <- 1-p    }"
"0","    if(log.p){        p <- log(p) }"
"0","    p"
"0","}"
"0","cant_cdf <- pCantor(seq(0,1, by = 0.00001))"
"0","ggplot(data.frame(x = seq(0,1, by = 0.00001), y = cant_cdf), aes(x = x, y = y)) +"
"0","  geom_line()"
