"0",""
"0","# b"
"0","samps  <- as.data.frame(matrix(data = NA, nrow = 4 * nsamps, ncol = 3))"
"0","samps[1:nsamps,1:2] <- rmvnorm(nsamps, mu_A, Sigma_A)"
"0","samps[1:nsamps,3]   <- ""marginal"""
"0","for (i in 1:3) {"
"0","  b <- rnorm(1, mu_B, Sigma_B)"
"0","  samps[(i*nsamps + 1):((i + 1) * nsamps), 1:2] <- rmvnorm(nsamps,"
"0","                                                           mu_a + tmp_a * b,"
"0","                                                           Sigma_d)"
"0","  samps[(i*nsamps + 1):((i + 1) * nsamps), 3] <- b"
"0","}"
"0","colnames(samps) <- c(""x"", ""y"", ""dist"")"
"0","ggplot(samps, aes(x = x, y = y)) +"
"0","  geom_point() +"
"0","  geom_smooth(method = ""lm"") +"
"0","  facet_wrap(~ dist)"
