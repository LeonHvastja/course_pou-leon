"0","library(mvtnorm)"
"0","set.seed(1)"
"0","nsamps <- 1000"
"0",""
"0","# a"
"0","samps  <- as.data.frame(matrix(data = NA, nrow = 4 * nsamps, ncol = 2))"
"0","samps[1:nsamps,1] <- rnorm(nsamps, mu_B, Sigma_B)"
"0","samps[1:nsamps,2] <- ""marginal"""
"0","for (i in 1:3) {"
"0","  a <- rmvnorm(1, mu_A, Sigma_A)"
"0","  samps[(i*nsamps + 1):((i + 1) * nsamps), 1] <- rnorm(nsamps,"
"0","                                                       mu_b + tmp_b %*% t(a),"
"0","                                                       Sigma_b)"
"0","  samps[(i*nsamps + 1):((i + 1) * nsamps), 2] <- paste0(# ""cond"", "
"0","                                                        round(a, digits = 2), "
"0","                                                        collapse = """")"
"0","}"
"0","colnames(samps) <- c(""x"", ""dist"")"
"0","ggplot(samps, aes(x = x)) +"
"0","  geom_density() +"
"0","  facet_wrap(~ dist)"
