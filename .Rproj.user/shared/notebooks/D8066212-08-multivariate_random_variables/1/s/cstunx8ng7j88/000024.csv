"0","# a"
"0","set.seed(1)"
"0","sigma <- matrix(data = c(0.3, -0.5,"
"0","                         -0.5, 1.6),"
"0","                nrow  = 2,"
"0","                byrow = TRUE)"
"0","ed    <- eigen(sigma)"
"0","e_val  <- ed$values"
"0","e_vec  <- ed$vectors"
"0",""
"0",""
"0",""
"0","# b"
"0","set.seed(1)"
"0","nsamps <- 1000"
"0","X      <- matrix(data = rnorm(nsamps * 2), ncol = 2)"
"0","vec1   <- matrix(c(1,0,0,1), nrow = 2)"
"0",""
"0","X2     <- t(sqrt(diag(e_val)) %*% t(X))"
"0","vec2   <- sqrt(diag(e_val)) %*% vec1"
"0",""
"0","X3     <- t(e_vec %*% t(X2))"
"0","vec3   <- e_vec %*% vec2"
"0",""
"0","X4     <- t(c(-2, 1) + t(X3))"
"0","vec4   <- c(-2, 1) + vec3"
"0",""
"0","vec_mat <- data.frame(matrix(c(0,0,0,0,0,0,0,0,0,0,0,0,-2,1,-2,1), ncol = 2, byrow = TRUE),"
"0","                      t(cbind(vec1, vec2, vec3, vec4)),"
"0","                      c(1,1,2,2,3,3,4,4))"
"0",""
"0",""
"0","df     <- data.frame(rbind(X, X2, X3, X4), c(rep(1, nsamps),"
"0","                                             rep(2, nsamps),"
"0","                                             rep(3, nsamps),"
"0","                                             rep(4, nsamps)))"
"0",""
"0",""
"0","colnames(df) <- c(""D1"", ""D2"", ""wh"")"
"0","colnames(vec_mat) <- c(""D1"", ""D2"", ""E1"", ""E2"", ""wh"")"
"0","ggplot(data = df, aes(x = D1, y = D2)) +"
"0","  geom_point() +"
"0","  geom_segment(data = vec_mat, aes(xend = E1, yend = E2), color = ""red"") +"
"0","  facet_wrap(~ wh) +"
"0","  coord_fixed()"
