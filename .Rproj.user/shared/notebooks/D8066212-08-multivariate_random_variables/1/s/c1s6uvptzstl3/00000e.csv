"0","library(mvtnorm)"
"0","set.seed(1)"
"0","mvn_dens <- function (y, mu, Sigma) {"
"0","  L     <- chol(Sigma)"
"0","  L_inv <- solve(t(L))"
"0","  g_inv <- L_inv %*% t(y - mu)"
"0","  J     <- L_inv"
"0","  J_det <- det(J)"
"0","  return(prod(dnorm(g_inv)) * J_det)"
"0","}"
"0","mu_v  <- c(-2, 0, 1)"
"0","cov_m <- matrix(c(1, -0.2, 0.5,"
"0","                  -0.2, 2, 0.3,"
"0","                  0.5, 0.3, 1.6),"
"0","                ncol  = 3,"
"0","                byrow = TRUE)"
"0","n_comp <- 20"
"0","for (i in 1:n_comp) {"
"0","  x <- rmvnorm(1, "
"0","             mean  = mu_v,"
"0","             sigma = cov_m)"
"0","  print(paste0(""My function: "","
"0","               mvn_dens(x, mu_v, cov_m),"
"0","               "", dmvnorm: "","
"0","               dmvnorm(x, mu_v, cov_m)))"
"0","}"
"1","[1]"
"1"," ""My function: 0.0229514237156383, dmvnorm: 0.0229514237156383"""
"1","
"
"1","[1]"
"1"," ""My function: 0.00763138915406231, dmvnorm: 0.00763138915406232"""
"1","
"
"1","[1]"
"1"," ""My function: 0.0230688881105741, dmvnorm: 0.0230688881105741"""
"1","
"
"1","[1]"
"1"," ""My function: 0.0113616213114732, dmvnorm: 0.0113616213114732"""
"1","
"
"1","[1]"
"1"," ""My function: 0.00151808500121908, dmvnorm: 0.00151808500121908"""
"1","
"
"1","[1]"
"1"," ""My function: 0.0257658045974509, dmvnorm: 0.0257658045974509"""
"1","
"
"1","[1]"
"1"," ""My function: 0.0157963825730805, dmvnorm: 0.0157963825730805"""
"1","
"
"1","[1]"
"1"," ""My function: 0.00408856287529248, dmvnorm: 0.00408856287529248"""
"1","
"
"1","[1]"
"1"," ""My function: 0.0327793540101256, dmvnorm: 0.0327793540101256"""
"1","
"
"1","[1]"
"1"," ""My function: 0.0111606542967978, dmvnorm: 0.0111606542967978"""
"1","
"
"1","[1]"
"1"," ""My function: 0.0147636757585684, dmvnorm: 0.0147636757585684"""
"1","
"
"1","[1]"
"1"," ""My function: 0.0142948300412208, dmvnorm: 0.0142948300412208"""
"1","
"
"1","[1]"
"1"," ""My function: 0.0203093820657542, dmvnorm: 0.0203093820657542"""
"1","
"
"1","[1]"
"1"," ""My function: 0.0287533273357481, dmvnorm: 0.0287533273357481"""
"1","
"
"1","[1]"
"1"," ""My function: 0.0213402305128623, dmvnorm: 0.0213402305128623"""
"1","
"
"1","[1]"
"1"," ""My function: 0.0218356957993885, dmvnorm: 0.0218356957993885"""
"1","
"
"1","[1]"
"1"," ""My function: 0.0250750113961771, dmvnorm: 0.0250750113961771"""
"1","
"
"1","[1]"
"1"," ""My function: 0.0166498666348048, dmvnorm: 0.0166498666348048"""
"1","
"
"1","[1]"
"1"," ""My function: 0.0018972510687466, dmvnorm: 0.0018972510687466"""
"1","
"
"1","[1]"
"1"," ""My function: 0.0196697814975113, dmvnorm: 0.0196697814975113"""
"1","
"
